# Dark DAO Lite

Our Dark DAO Lite system represented in this folder features an autonomous wallet design with a self-auctioning vote-selling mechanism.

## Details

**Converting target-DAO tokens to DD tokens.** The Dark DAO Lite issues _DD tokens_ which represent a claim to both underlying target-DAO tokens and the proportional bribes obtained from selling DAO votes. Before DD tokens can be minted, the Dark DAO first needs to gain control over target-DAO tokens. This is accomplished by having users sent target-DAO tokens to a freshly generated encumbered wallet controlled by the Dark DAO.

A user wishing to receive DD tokens makes an off-chain query to the Dark DAO contract for a newly generated address where a batch of target-DAO tokens may be deposited. The Dark DAO contract responds with the deposit address $A$ and a ciphertext $C$ of deposit data ($sk_A$, $R$), where $sk_A$ is the private key for $A$ and $R$ is the address for receiving DD tokens minted as a result of a deposit to $A$.

The reason for creating a fresh address for each deposit is _confidentiality_ of these addresses. Since the generation process happens off chain, there is no public indication that $A$ is controlled by the Dark DAO. The deposit is indistinguishable from a simple transfer of target-DAO tokens to a new EOA (externally owned account).

After the user transfers target-DAO tokens to $A$, the user submits a state proof of $A$'s target-DAO token balance to the Dark DAO contract, along with the ciphertext $C$. The use of state proofs serves as a bridge between Ethereum and Oasis; we assume a trusted source of block hashes for this purpose. The Dark DAO contract checks the proof which begins an optional _lockup period_ on the tokens. After the lockup period is complete, the user queries the contract to receive a signed message authorizing the minting of an equivalent amount of DD tokens to the user. The DD token contract on Ethereum accepts this signed message to mint the DD tokens. The mint operation need not happen immediately; the user could presumably wait until the DD tokens need to be transferred or sold.

We emphasize that users with DD tokens cannot vote in the target DAO with them; this voting ability is in the Dark DAO's self-auctioning pool. Rather, DD tokens hold a claim to ownership in the target DAO plus a proportional fraction of the bribe revenue the Dark DAO creates from selling its votes. In short, 1 DD token is equivalent to the ownership rights of 1 target DAO token plus fractional bribe revenue.

**Redeeming DD tokens for target-DAO tokens.** The conversion process may be reversed: DD tokens can be redeemed for their underlying target-DAO tokens. A user holding DD tokens first issues a burn transaction of $n$ tokens to the DD token contract, which removes the $n$ DD tokens from circulation and records a receipt of the burn to persistent storage. The user then submits a state proof of the burn receipt to the Dark DAO contract on Oasis, which in return sends back a proportional amount of bribe money and authorizes the user to submit off-chain withdrawal requests to the Dark DAO contract. The Dark DAO responds to such a request with a signed Ethereum transaction which transfers up to $n$ target-DAO tokens from a Dark DAO controlled account to the user. It is the user's responsibility to include this transaction on the Ethereum mainnet. Note that DD tokens must be fungible and liquid, or else they would not be easily tradable; therefore, the Dark DAO contract must be able to handle partial withdrawals from its accounts.

**Voting-rights auctioning.** We assume that the target DAO utilizes a message-based, off-chain voting system with voting power assigned to accounts based on their DAO token balances, though the Dark DAO contract could be adapted for other voting schemes. When a target-DAO proposal is published, the proposal hash is made public. Bribers who wish to purchase the Dark DAO's voting power for the proposal can start an auction for that proposal from the Dark DAO contract and bid on the right to sign votes from all Dark DAO accounts. (In our implementation, bids are made in Oasis's native token, ROSE. Over time, the DD token will have increased exposure to this other asset. To remedy this, the Dark DAO contract can sell its proceeds periodically for the target-DAO token.) Our implementation uses a first-price auction, yet other auction types could be substituted. All auctions have a fixed duration and must end before the proposal expires, or else the purchased votes cannot be used.

A briber who wins an auction can ask the Dark DAO contract to sign votes for the proposal from all of the Dark DAO accounts. Bidders could bid on a hash that does not correspond to a proposal, so as implemented, any auction winner can enumerate Dark DAO accounts by reading the vote signatures.

**How the DD-token market works.** As conversion of target-DAO tokens to DD tokens requires a (small) degree of technical knowledge, including interaction with the Oasis Sapphire chain, our expectation is that arbitrageurs will perform the conversion. As ordinary ERC-20 tokens, DD tokens may be sold in either decentralized or centralized exchanges. The value of generating DD tokens---and thus revenue for arbitrageurs---may be priced into the market value of DD tokens.

Whether a given user prefers to hold target-DAO tokens or DD tokens depends upon the value to the user of voting for a set of elections $E$ over which the user intends to hold DD tokens. Given high utility, i.e., a particular desired outcome, a user may prefer to vote and thus hold target-DAO tokens. Many users, however, are apathetic and would derive higher utility instead from holding DD tokens. The technical requirements and user experience for holding the two types of token are identical.

## Security

The Dark DAO Lite achieves weaker confidentiality than a regular Dark DAO, though its integrity and availability properties are the same, due to the _liquidity_ of DD tokens.

Recall that when _deposited_, target-DAO tokens are transferred to a Dark-DAO-generated address that is indistinguishable on chain from an ordinary EOA. When DD tokens are _redeemed_ for target-DAO tokens, however, the address in which they are held is revealed to the redeeming player to be part of the Dark DAO. Furthermore, the liquidity of tokens enables one user to redeem tokens deposited by another user. An adversary can perform redemptions strategically in an attempt to enumerate Dark-DAO accounts.

For example, suppose that players only deposit one token at a time and that redemptions are LIFO (last in, first out). An adversary $A$ can deposit a token and wait until another player P1 deposits a token. $A$ then withdraws its token, revealing P1's deposit address, and then redeposits its token. $A$ can do the same when P2 deposits a token, and so forth. In principle, by withdrawing and depositing $t$ tokens over intervals of length $\Delta$, where $t$ is at least as large as other players' deposits over any interval of length $\Delta$, $A$ can identify all deposit addresses.

Such discovery of deposit addresses through strategic redemption is somewhat costly in practice, because it incurs transaction costs. Our current Dark DAO Lite implementation in fact uses FIFO scheduling. It is possible to impede adversarial address-discovery strategies against FIFO by imposing a lockup period on deposited tokens. The effect of this practice is to raise the adversary's capital requirements, i.e., require the adversary to control a large number tokens. Other approaches might be more effective and their exploration constitutes an interesting research challenge.

An additional form of information leakage in a Dark DAO Lite arises because the circulating supply of DD tokens is publicly visible. The quantity of these tokens specifies corresponds to the size of the available pool of votes available for purchase in the Dark DAO. (It is possible in principle to enhance a Dark DAO Lite to mint fake DD tokens, a potential future enhancement.) Furthermore, on-chain transaction analysis may leak futher information. For example, the timing of target-DAO token deposits and DD token issuance can help an adversary infer target-DAO token addresses.
